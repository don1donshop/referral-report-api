<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>📋 推薦人訂單查詢</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
  
<body>
  <h1>📋 推薦人訂單查詢</h1>

  <label>推薦碼：</label>
  <select id="referralCode" onchange="onCodeChange()">
    <option value="">請選擇推薦碼</option>
    <option value="LAVONS88">LAVONS88</option>
    <option value="LAVONS_WINNIE">LAVONS_WINNIE</option>
    <option value="LAVONS_XIAOSHAN">LAVONS_XIAOSHAN</option>
  </select>

  <div id="tokenBlock" class="hidden">
    <label>Access Token：</label>
    <input type="password" id="accessToken" placeholder="請輸入 token" />
  </div>

  <label>起始時間：</label>
  <input type="datetime-local" id="startTime" />

  <label>結束時間：</label>
  <input type="datetime-local" id="endTime" />

  <br>
  <button onclick="fetchOrders()">查詢訂單</button>

  <div id="stats"></div>
  <small id="statsNote" class="hidden" style="color: #888;">＊有效訂單：僅統計「已付款 且 未取消」的訂單</small>
  <!-- <button onclick="exportCSV()">📤 匯出報表 (CSV)</button> -->

  <div id="infoBox" class="hidden" style="padding: 1em; background: #e0f7fa; border: 1px solid #4dd0e1; margin-bottom: 1em;">
    👋 你正在以推薦碼 <b id="referralCodeDisplay"></b> 的身份查詢訂單。
  </div>

  <table id="results">
    <thead>
      <tr>
        <th>訂單編號</th>
        <th>成立時間</th>
        <th>金額</th>
        <th>付款狀態</th>
        <th>出貨狀態</th>
        <th>狀態</th>
        <th>備註</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- ✅ JS 放在這裡，確保 HTML 已完成渲染 -->
  <script src="{{ url_for('static', filename='js/referral-report.js') }}"></script>
</body>
</html>
