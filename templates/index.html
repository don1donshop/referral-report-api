<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>📋 推薦人訂單查詢</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
  <div class="container">
    <h1>📋 推薦人訂單查詢</h1>

    <label>推薦碼：</label>
    <select id="referralCode" onchange="onCodeChange()">
      <option value="">請選擇推薦碼</option>
      <option value="LAVONS88">LAVONS88</option>
      <option value="LAVONS_WINNIE">LAVONS_WINNIE</option>
      <option value="LAVONS_XIAOSHAN">LAVONS_XIAOSHAN</option>
    </select>

    <div id="tokenBlock" class="hidden">
      <label>Access Token：</label>
      <input type="password" id="accessToken" placeholder="請輸入 token" />
    </div>

    <label>起始時間：</label>
    <input type="datetime-local" id="startTime" />

    <label>結束時間：</label>
    <input type="datetime-local" id="endTime" />

    <button onclick="fetchOrders()">查詢訂單</button>

    <div id="infoBox" class="hidden">
      👋 你正在以推薦碼 <b id="referralCodeDisplay"></b> 的身份查詢訂單。
    </div>

    <div id="stats"></div>
    <div id="statsNote" class="hidden">📌 統計僅包含「已付款」「未退款」「未取消」的訂單。</div>
    <button id="csvBtn" class="hidden">📤 匯出報表 (CSV)</button>

    <!-- 📦 單品銷售統計區塊 -->
    <div id="skuStatsBlock" class="feature-block hidden">
      <h2>📦 單品銷售統計</h2>
      <p style="margin-bottom: 1em; color: #666;">查詢訂單後將顯示單品統計結果</p>
      <table id="skuStatsTable">
        <thead>
          <tr><th>單品 SKU</th><th>商品名稱</th><th>總數量</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="table_mb">
      <table id="results">
        <thead>
          <tr>
            <th>訂單編號</th>
            <th>成立時間</th>
            <th>金額</th>
            <th>付款狀態</th>
            <th>出貨狀態</th>
            <th>系統狀態</th>
            <th>備註</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/referral-report.js') }}"></script>
</body>
</html>
