<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>📋 推薦人訂單查詢</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <div class="container">

    <h1>📋 推薦人訂單查詢</h1>

    <!-- 表單區塊 -->
    <label>推薦碼：</label>
    <select id="referralCode" onchange="onCodeChange()">
      <option value="">請選擇推薦碼</option>
      <!--
      <option value="LAVONS88">LAVONS88</option>
      <option value="LAVONS_WINNIE">LAVONS_WINNIE</option>
      <option value="LAVONS_XIAOSHAN">LAVONS_XIAOSHAN</option>
      -->    
      <option value="LAVONS_XIAOKE">LAVONS_XIAOKE</option>
    </select>

    <div id="tokenBlock" class="hidden">
      <label>Access Token：</label>
      <input type="password" id="accessToken" placeholder="請輸入 token" />
    </div>

    <label>起始時間：</label>
    <input type="datetime-local" id="startTime" />

    <label>結束時間：</label>
    <input type="datetime-local" id="endTime" />

    <button onclick="fetchOrders()">查詢訂單</button>

    <!-- 狀態訊息 -->
    <div id="infoBox" class="hidden">
      👋 你正在以推薦碼 <b id="referralCodeDisplay"></b> 的身份查詢訂單。
    </div>

    <div id="stats"></div>
    <div id="statsNote" class="hidden">
      📌 統計僅包含「已付款」且「未取消」且「未退款」的訂單。
    </div>

    <button id="csvBtn" class="hidden">📤 匯出報表 (CSV)</button>

    <!-- 商品統計排序選項 
    <div class="sort-bar hidden">
      <label for="skuSortSelect">🔽 商品排序方式：</label>
      <select id="skuSortSelect" onchange="onChangeSKUSort()">
        <option value="count">依數量（高→低）</option>
        <option value="name" selected>依品名（A→Z）</option>
      </select>
    </div>    -->
    
    <!-- SKU 統計表 不啟用
    <div id="skuStatsBox" class="hidden">
      <h2>📦 商品數量統計（有效訂單）</h2>
      <table id="skuStatsTable">
        <thead>
          <tr>
            <th>商品名稱</th>
            <th>SKU</th>
            <th>數量</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>  -->
    
    <!-- 訂單結果表格 -->
    <div class="table_mb">
      <table id="results">
        <thead>
          <tr>
            <th>訂單編號</th>
            <th>成立時間</th>
            <th>金額</th>
            <th>付款狀態</th>
            <th>出貨狀態</th>
            <th>系統狀態</th>
            <th>備註</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

  </div> <!-- /container -->

  <!-- JS 載入 -->
  <script src="{{ url_for('static', filename='js/referral-report.js') }}"></script>
</body>
</html>
